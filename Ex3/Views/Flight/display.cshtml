@{
    Layout = null;
}


<html>
<head>
    <style>
        html, body {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body onload="draw();">
    <canvas id="canvas" style="position:absolute; left:0px; top:0px"></canvas>
    <!--img id="map" src="/map.png" /-->
</body>
</html>
<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>

<div>
    <h2>FLIGHT:</h2>
    <table>
        <tr>
            <td>Lon:  </td>
            <td><p type="text" id="Lon" size="5"></p></td>
        </tr>
        <tr>
            <td>lat:  </td>
            <td><p type="text" id="Lat" size="5"></p></td>
        </tr>
    </table>
</div>


<script>
    function draw() {

        var img = new Image();
        img.onload = function () {
            var ctx = document.getElementById('canvas').getContext('2d');
            ctx.canvas.width = window.innerWidth;
            ctx.canvas.height = window.innerHeight;
            ctx.drawImage(img, 0, 0, window.innerWidth, window.innerHeight);
            var IntervalTime = @Session["time"] * 1000
            
            myTimer = (function () {
        
                $.post("@Url.Action("GetFlightData")").done(function (xml) {
                    var xmlDoc = $.parseXML(xml),
                        $xml = $(xmlDoc),
                        Lon = $xml.find("Lon").text();
                    Lat = $xml.find("Lat").text();
                    var c = document.getElementById("canvas");
                    var ctx1 = c.getContext("2d");
                    var x1 = parseFloat(Lon.valueOf());
                    var y1 = parseFloat(Lat.valueOf());
                    ctx.beginPath();
                    ctx.arc(400, 200, 50, 0, 2 * Math.PI);
                    ctx.fillStyle = 'yellow';
                    ctx.fill();
                    ctx.lineWidth = 2;
                    ctx.strokeStyle = 'black';
                    ctx.stroke();
                    $("#Lon").text(Lon);
                    $("#Lat").text(Lat);


                });
            });
            var context = canvas.getContext('2d');
            // var x = (window.innerWidth / 360) * ( parseFloat(Lon.valueOf()) + 180);
            // var y = (window.innerWidth / 180) * ( parseFloat(Lat.valueOf()) + 90);
            var ty = "600";
            var x = parseFloat(ty.valueOf());
            //var y = parseFloat(Lat.valueOf());
            //var x = Convert.ToDouble(Lon);
            //var x = 600;
            var y = 100;
            context.beginPath();
            context.arc(x, y, 50, 0, 2 * Math.PI);
            context.fillStyle = 'red';
            context.fill();
            context.lineWidth = 2;
            context.strokeStyle = 'black';
            context.stroke();
           // $("#Lon").text(Lon);
            //$("#Lat").text(Lat);
        };
        img.src = '/map.png';
        if (IntervalTime != 0) {
            setInterval(myTimer, IntervalTime);
            myTimer();
        }

    }
</script>
<script>

    drawDot = (function (x, y) {
        var img = new Image();
        img.onload = function () {
            ctx.drawImage(img, 0, 0, window.innerWidth, window.innerHeight);
            var context = canvas.getContext('2d');
            var lon = x;
            var lat = y;
            //var x = (window.innerWidth / 360) * (lon + 180);
            //var y = (window.innerHeight / 180) * (lat + 90);
            context.beginPath();
            context.arc(x, y, 5, 0, 2 * Math.PI);
            context.fillStyle = 'red';
            context.fill();
            context.lineWidth = 2;
            context.strokeStyle = 'black';
            context.stroke();
        }
    });
    img.src = '/map.png';

}

</script>

<!--style="border:1px solid #d3d3d3-->
